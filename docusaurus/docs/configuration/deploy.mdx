---
title: Deploy
---

:::info
The deploy section might move to using kaniko and helm in the close future.
The following steps will still apply.
:::

The included deploy job will deploy your project to OpenShift. For this to work, you need to create a project in OpenShift, and acquire a token for Openshift.

## Create project

### UI

Go to [our OpenShift instance](https://openshift.intility.no:8443/) and log in.

Create a project, the name should be `aa-<GITLAB_SLUG>-dev`, e.g. `aa-my-app-dev`.  
If you use something other than this, you'll need to modify the `OPENSHIFT_PROJECT` variable in the top of the .gitlab-ci.yml file.  
Add a fitting display name and description if you feel like it.

### CLI

The name should be `aa-<GITLAB_SLUG>-dev`, e.g. `aa-my-app-dev`.  
If you use something other than this, you'll need to modify the `OPENSHIFT_PROJECT` variable in the top of the .gitlab-ci.yml file.

```bash
oc new-project <projectname>
```

## Acquire Token

In this step we will use the [OpenShift CLI](https://docs.openshift.com/container-platform/3.11/cli_reference/get_started_cli.html).  
Copy login command from OpenShift Console and paste it in a terminal.  
After logging in, the CLI will show you available projects. Follow the instructions to change to the project you just created.

When you have selected the right project, we need to create a Service Account.

```bash
oc create sa gitlab-builder
oc describe sa gitlab-builder
```

Note the `gitlab-builder-token-*` in the `Mountable secrets` section.

Then we have to set the user to admin.

```bash
oc policy add-role-to-user edit -z gitlab-builder
```

Lastly, we have to extract the token from the secret presented in the first step.

```bash
oc describe secret <secret-name>
```

Copy the contents from the `token` section and [add it to GitLab CI/CD variables](/configuration/gitlab#adding-cicd-variables) with the key `OPENSHIFT_TOKEN`.
