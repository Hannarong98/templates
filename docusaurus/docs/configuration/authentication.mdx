---
title: AAD Authentication
---

The example code is set up to use authentication. For this to work, an App Registration has to be set up in Azure AD.

### UI

Head over to [Azure -> Azure Active Directory -> App registrations](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredApps)
with your Intility Account, and create a new registration.

![New Registration in Azure](/img/azure-new.png)  
Select a fitting name for your project, this name will be presented to the user during consent.

Under `Supported account types`, choose either `Intility AS only - Single tenant` or `Any Azure AD directory - Multitenant`.
This can be changed later, so if you're unsure what to choose, select single tenant.

Under `Redirect URI`, select `Single-page application (SPA)` from the dropdown, and enter `http://localhost:3000`.

Hit the register button, and you will be taken to an overview of your newly created registration.

![Finding Client ID](/img/azure-clientid.png)  
Copy the `Application (Client) ID` GUID, and paste it into the `clientId` field in your `index.tsx` file.

```jsx title="src/index.tsx"
const msal = {
  auth: {
    clientId: "YOUR_CLIENT_ID",
    ...
  },
  ...
}
```

Check out [Enabling authentication in your app](#enabling-authentication-in-your-app) to enable authentication in your app.

### Adding reply URLs

For each deployment of your app, you'll need to register it. You can do that by going to the Authentication page.

![Adding Reply URLs](/img/azure-replyurls.png)  
The first we need to add is the URL the deploy step makes in OpenShift:

```
https://{your-project-slug}.openshift-inside.intility.no
```

You can also add more later if you create more environments.

## CLI

Login with the Azure CLI and run the following command (rember to modify the displayName)

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs
  groupId="shell"
  defaultValue="bash"
  values={[
  {
    label: 'bash',
    value: 'bash'
  }, {
    label: 'PowerShell',
    value: 'ps'
  }
  ]}
>
<TabItem value="bash">

```bash
az rest -u https://graph.microsoft.com/v1.0/applications -m post -b '{"displayName":"MyApp","spa":{"redirectUris":["http://localhost:3000"]}}'
```

</TabItem>
<TabItem value="ps">

```ps
az rest -u https://graph.microsoft.com/v1.0/applications -m post -b '{\"displayName\":\"MyApp\",\"spa\":{\"redirectUris\":[\"http://localhost:3000\"]}}'
```

</TabItem>
</Tabs>

Copy the `appId` GUID, and paste it into the `clientId` field in your `index.tsx` file.

```jsx title="src/index.tsx"
const msal = {
  auth: {
    clientId: "YOUR_CLIENT_ID",
    ...
  },
  ...
}
```

Check out [Enabling authentication in your app](#enabling-authentication-in-your-app) to enable authentication in your app.

## Enabling authentication in your app

Depending on what your applications scope is, there are different ways of enabling authentication.

### Forcing auth

This is the simplest way, and can be enabled by adding the `forced` prop to `MsalBrowserProvider`.

```jsx title="src/index.tsx"
ReactDOM.render(
  <Router>
    <MsalBrowserProvider config={msal} forced>
                                       ^^^^^^
      <React.StrictMode>
        <App />
      </React.StrictMode>
    </MsalBrowserProvider>
  </Router>,
  document.getElementById("root")
)
```

This will force user authentication, and your app won't render unless the user is authenticated.

### Conditional auth

If you don't want forced auth, you can implement a simple log-in button by using the `useAuth` hook from `@intility/react-msal-browser`.

```jsx
import { Button } from '@intility/bifrost-react'
import { useAuth } from '@intility/react-msal-browser'

const LoginButton = () => {
  const { login } = useAuth()
  
  return (
    <Button onClick={login}>Login</Button>
  )
}
```

And elsewhere in your app you can determin the login status by checking the existance of a user with `useUser`.

```jsx
import { useUser } from '@intility/react-msal-browser'

const MyComponent = () => {
  const user = useUser()

  return (
    <span>{ user !== null ? 'Hello friend.' : 'Who are you?' }</span>
  )
}
```